<!DOCTYPE html>
<html lang="en">
@@include('layout/head.html', {
    'title': '線上占卜'
})
<link rel="stylesheet" href="css/online_divination.css">
<body>
    
<!-- 網頁頭 -->
<!-- <header class="main_header"></header> -->
@@include('layout/header.html')


<!-- 網頁內容 -->
<main id="app">
     <!-- 塔羅頁籤 謝謝蘋姊拯救世界 by NJ -->
     @@include('layout/tar_page.html')

    <!-- 線上占卜 by NJ -->
    <!-- 占卜選項 -->
    <section class="basicinfor">
        <div class="container">

            <!-- 容器到item_box，從item開始才是正式內容 -->
            <h1>線上占卜</h1>
            <div class="question_box">
                <h2>想要占卜甚麼問題?</h2>
            </div>

                
            <div class="content">

                <!-- 工作 -->
                <div class="card">
                    <div class="front">
                        <h3>工作</h3>
                    </div>
                </div>
                
                <!-- 健康 -->
                <div class="card">
                    <div class="front">
                        <h3>健康</h3>
                    </div>
                </div>
                <!-- 愛情 -->
                <div class="card">
                    <div class="front">
                        <h3>愛情</h3>
                    </div>
                </div>
                <!-- 財富 -->
                <div class="card">
                    <div class="front">
                        <h3>財富</h3>
                    </div>
                </div>

            </div>
                
        </div>
    </section>

</main>


<!-- 網頁尾 -->
<!-- 內容由 common.js 新增 by PIN -->
<!-- <footer class="main_footer"></footer> -->
@@include('layout/footer.html')
<script>

        new Vue({
            el: '#app',
            data: { //變數放這
                urls: {
                    '體驗占卜師': 'be_tellers.html',
                    '線上占卜': 'online_divination.html',
                    '預約占卜師': 'teller_mem.html',
                    '塔羅討論區': 'discuss.html',
                },
                navs: ['體驗占卜師','線上占卜','占卜師總覽','塔羅討論區'],
            },
         });


    for(let i=0; i< 4; i++){
    const card = document.querySelectorAll('.card')[i];
    const front = document.querySelectorAll('.card .front')[i];
    const back = document.querySelectorAll('.card .back')[i];
        card.addEventListener('click', () => {
            
            back.classList.toggle("rotate");
            front.classList.toggle("flip");
        });
    }




// =================================================================
// 撈問題

    function getQuestionList() {
        $.ajax({
            type: 'POST',
            url: 'phps/select.php',
            data: {
                // 要查詢的資料表
                table: 'divination',
                // 要查詢的欄位
                queryCol: '*',
            },
            success: function(data) {
                if (data.msg !== false){
                    // console.log(data.msg);
                    let cards = $('.card');
                    // console.log(cards);
                    for (let i = 0; i < data.msg.length; i++) {
                        let typeno = data.msg[i].typeNo;
                        // let card = cards[typeno]; // 這個問題放在哪個卡片裡
                        // console.log(cards.children());
                        let card = $(`.card:nth-child(${typeno})`);
                        let back = $(`.card:nth-child(${typeno}) .back`);
                        if (back.length === 0) {
                            // console.log(card);
                            back = document.createElement("div");
                            back.classList.add("back");
                            card.append(back);
                            let backDiv = document.createElement("div");
                            back.append(backDiv);
                        }
                            let a = document.createElement('a');
                            a.href = `draw_cards.html?type=${typeno}&no=${data.msg[i].divNo}`;
                            a.classList.add('cardLink');
                            $(`.card:nth-child(${typeno}) .back div`).append(a); 
                            // let cardLink = document.querySelector('.cardLink');
                            let cardBtn = document.createElement('button');
                            cardBtn.classList.add('choose_btn');
                            cardBtn.innerHTML = data.msg[i].title;
                            a.appendChild(cardBtn);
                            
                        
                        
                        // console.log(card);
                        
                    }
                }
            },
            error: function() {
                console.log('ajax error');
            }
        });
    }
    // 何時要?
    window.addEventListener('load', getQuestionList);

</script>
</body>
</html>